<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Network Analyzer Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Network Packet Visualizer</h1>
    <canvas id="protoChart" width="600" height="300"></canvas>
    <h2>Top Sources</h2>
    <ul id="topSrc"></ul>

    <script>
    async function load() {
        const r = await fetch('/api/summary');
        if (!r.ok) return;
        const s = await r.json();
        const labels = s.protocol_distribution.map(x=>x[0]);
        const values = s.protocol_distribution.map(x=>x[1]);
        const ctx = document.getElementById('protoChart').getContext('2d');
        new Chart(ctx, {type:'bar', data:{labels:labels, datasets:[{label:'Packets', data:values}]}});

        const ul = document.getElementById('topSrc');
        s.top_src.slice(0,10).forEach(t => {
            const li = document.createElement('li');
            li.textContent = t[0] + ' â€” ' + t[1] + ' packets';
            ul.appendChild(li);
        });
    }
    load();
    </script>
</body>
</html>
